<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Now Playing</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #121212;
    color: white;
}

.container {
    padding: 20px;
}

.song-title {
    font-size: 26px;
    font-weight: bold;
}

.meta {
    color: #aaa;
    margin-top: 5px;
}

.player {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: #181818;
    padding: 15px;
    display: flex;
    gap: 10px;
    align-items: center;
}

button {
    background: #1db954;
    border: none;
    padding: 12px 18px;
    border-radius: 50px;
    cursor: pointer;
    font-size: 16px;
}

.progress {
    width: 100%;
}
</style>
</head>

<body>

<div class="container">
    <div class="song-title" id="title">No song</div>
    <div class="meta" id="plays"></div>
    <div class="meta" id="likes"></div>
</div>

<div class="player">
    <button id="playBtn">▶ Play</button>
    <input type="range" id="progress" class="progress" value="0">
</div>

<audio id="audio" controls hidden></audio>

<script>
const params = new URLSearchParams(window.location.search);
const songFile = params.get("song");

const audio = document.getElementById("audio");
const title = document.getElementById("title");
const plays = document.getElementById("plays");
const likes = document.getElementById("likes");
const progress = document.getElementById("progress");
const playBtn = document.getElementById("playBtn");

function fake(min, max) {
    return Math.floor(Math.random() * (max - min) + min);
}

if (!songFile) {
    title.textContent = "No song in URL";
} else {
    audio.src = decodeURIComponent(songFile);

    title.textContent = songFile.replace(".mp3", "");
    plays.textContent = `${fake(10_000, 2_000_000).toLocaleString()} plays`;
    likes.textContent = `❤ ${fake(1_000, 200_000).toLocaleString()}`;
}

playBtn.onclick = () => {
    audio.play().then(() => {
        playBtn.textContent = "⏸ Pause";
    }).catch(err => {
        alert("Click play manually — browser blocked autoplay");
    });
};

audio.addEventListener("pause", () => {
    playBtn.textContent = "▶ Play";
});

audio.addEventListener("play", () => {
    playBtn.textContent = "⏸ Pause";
});

audio.addEventListener("timeupdate", () => {
    progress.max = audio.duration || 0;
    progress.value = audio.currentTime || 0;
});

progress.addEventListener("input", () => {
    audio.currentTime = progress.value;
});
</script>

</body>
</html>
